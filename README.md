# BaseCut - é«˜æ€§èƒ½ Web è§†é¢‘å‰ªè¾‘å¼•æ“

<p align="center">
  <br>
  <img src="https://img.shields.io/badge/Vue-3.0+-4FC08D?style=flat-square&logo=vue.js" alt="Vue">
  <img src="https://img.shields.io/badge/TypeScript-5.0+-3178C6?style=flat-square&logo=typescript" alt="TypeScript">
  <img src="https://img.shields.io/badge/Vite-6.0+-646CFF?style=flat-square&logo=vite" alt="Vite">
  <img src="https://img.shields.io/badge/WebGL-2.0-990000?style=flat-square&logo=webgl" alt="WebGL">
  <img src="https://img.shields.io/badge/WebCodecs-Enabled-FF6B6B?style=flat-square" alt="WebCodecs">
  <br>
  <sub>åŸºäº WebGL ä¸ WebCodecs çš„ä¸‹ä¸€ä»£äº‘ç«¯è§†é¢‘å‰ªè¾‘è§£å†³æ–¹æ¡ˆ</sub>
</p>

---

## âš¡ï¸ æ ¸å¿ƒäº®ç‚¹

### ğŸš€ å·¥ä¸šçº§æ’­æ”¾å¼•æ“
- **MediaController æ¶æ„**ï¼šè‡ªç ”å¤šåª’ä½“æ§åˆ¶å™¨ï¼Œç²¾ç¡®åè°ƒè§†é¢‘ã€éŸ³é¢‘ä¸å­—å¹•åŒæ­¥ã€‚
- **VideoPool é¢„åŠ è½½æŠ€æœ¯**ï¼šåŸºäº LRU ç­–ç•¥çš„ 6 é€šé“è§†é¢‘æ± ï¼Œå®ç°å¤šè½¨é“ç´ æé›¶å»¶è¿Ÿåˆ‡æ¢ã€‚
- **PlaybackClock ç²¾ç¡®è®¡æ—¶**ï¼šç‹¬ç«‹äº UI çº¿ç¨‹çš„é«˜ç²¾åº¦æ—¶é’Ÿï¼Œæ¶ˆé™¤ `requestAnimationFrame` å¸¦æ¥çš„ç´¯ç§¯è¯¯å·®ã€‚
- **æ™ºèƒ½æ¸²æŸ“å¾ªç¯**ï¼šåˆ†ç¦»æ¸²æŸ“å¸§ç‡ä¸çŠ¶æ€æ›´æ–°é¢‘ç‡ï¼ˆ20fps UI / 60fps Renderï¼‰ï¼Œå½»åº•è§£å†³ Vue å“åº”å¼å¯¼è‡´çš„æ€§èƒ½ç“¶é¢ˆã€‚

### ğŸ¨ ä¸“ä¸šçº§æ¸²æŸ“èƒ½åŠ›
- **WebGL ç¡¬ä»¶åŠ é€Ÿ**ï¼šå…¨æµç¨‹ GPU å›¾åƒå¤„ç†ï¼Œæ”¯æŒå®æ—¶æ»¤é•œä¸ç‰¹æ•ˆã€‚
- **10+ è§†é¢‘ç‰¹æ•ˆ**ï¼šé—ªç™½ã€æ•…éšœã€è€ç”µå½±ã€å¾„å‘æ¨¡ç³Šã€è‰²å·®ã€åƒç´ åŒ–ã€æš—è§’ã€åˆ†å±ç­‰ã€‚
- **Ping-Pong æ¸²æŸ“**ï¼šå¤šç‰¹æ•ˆé“¾å¼å åŠ ï¼ŒçŠ¶æ€éš”ç¦»ç¡®ä¿æ¸²æŸ“ä¸€è‡´æ€§ã€‚
- **å¤šå±‚çº§åˆæˆç³»ç»Ÿ**ï¼šæ”¯æŒè§†é¢‘ã€å›¾ç‰‡ã€æ–‡å­—ã€è´´çº¸ç­‰å¤šè½¨é“æ··åˆæ¸²æŸ“ã€‚
- **ç‹¬ç«‹å­—å¹•å±‚**ï¼šåŸºäº Offscreen Canvas çš„é«˜æ€§èƒ½å­—å¹•æ¸²æŸ“ï¼Œæ”¯æŒåŠ¨æ€æ ·å¼ä¸ç²¾ç¡®æ—¶é—´è½´å¯¹é½ã€‚

### ğŸ¬ ä¸“ä¸šå¯¼å‡ºèƒ½åŠ›
- **WebCodecs ç¡¬ä»¶ç¼–ç **ï¼šåˆ©ç”¨ GPU åŠ é€Ÿè§†é¢‘ç¼–ç ï¼Œå¯¼å‡ºé€Ÿåº¦æå‡ 3-5 å€ã€‚
- **é¢„è§ˆå¯¼å‡ºä¸€è‡´**ï¼šç»Ÿä¸€æ¸²æŸ“ç®¡çº¿ï¼Œæ‰€è§å³æ‰€å¾—ã€‚
- **FBO é¢„æ¸²æŸ“**ï¼šç¡®ä¿ç‰¹æ•ˆã€å®½é«˜æ¯”åœ¨å¯¼å‡ºæ—¶ä¸é¢„è§ˆå®Œå…¨ä¸€è‡´ã€‚

### â˜ï¸ äº‘åŸç”Ÿå·¥ä½œæµ
- **HLS æµåª’ä½“æ”¯æŒ**ï¼šåŸç”Ÿæ”¯æŒ m3u8 æµåª’ä½“æ’­æ”¾ï¼Œæ— ç¼å¯¹æ¥äº‘ç«¯è½¬ç èµ„æºã€‚
- **Sprite ç¼©ç•¥å›¾å¼•æ“**ï¼šæ”¯æŒé•¿è§†é¢‘é›ªç¢§å›¾é¢„è§ˆï¼Œæ‹–æ‹½æ—¶é—´è½´å®æ—¶å“åº”ï¼Œé›¶å¡é¡¿ä½“éªŒã€‚
- **æ³¢å½¢å¯è§†åŒ–**ï¼šå¼‚æ­¥åŠ è½½éŸ³é¢‘æ³¢å½¢æ•°æ®ï¼Œæä¾›ç²¾å‡†çš„éŸ³é¢‘ç¼–è¾‘è¾…åŠ©ã€‚

---

## ğŸ›  æŠ€æœ¯æ¶æ„

### ç›®å½•ç»“æ„

```
vue-baseCut/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ engine/                  # æ ¸å¿ƒæ’­æ”¾ä¸æ¸²æŸ“å¼•æ“
â”‚   â”‚   â”œâ”€â”€ MediaController.ts   # å¤šåª’ä½“æ€»çº¿æ§åˆ¶ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”‚   â”œâ”€â”€ VideoPool.ts         # è§†é¢‘å…ƒç´ å¤ç”¨æ± ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
â”‚   â”‚   â”œâ”€â”€ PlaybackClock.ts     # é«˜ç²¾åº¦æ’­æ”¾æ—¶é’Ÿ
â”‚   â”‚   â”œâ”€â”€ WebGLRenderer.ts     # WebGL æ¸²æŸ“å™¨ï¼ˆæ»¤é•œ/ç‰¹æ•ˆ/è½¬åœºï¼‰
â”‚   â”‚   â”œâ”€â”€ EffectManager.ts     # ç‰¹æ•ˆç®¡ç†å™¨ï¼ˆPing-Pong æ¸²æŸ“ï¼‰
â”‚   â”‚   â”œâ”€â”€ EffectShaders.ts     # GLSL ç‰¹æ•ˆç€è‰²å™¨é›†åˆ
â”‚   â”‚   â”œâ”€â”€ WebCodecsExporter.ts # WebCodecs è§†é¢‘å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ HLSPlayer.ts         # HLS æµæ’­æ”¾å°è£…
â”‚   â”‚   â””â”€â”€ FFmpegCore.ts        # WASM åª’ä½“å¤„ç†æ ¸å¿ƒ
â”‚   â”‚
â”‚   â”œâ”€â”€ components/              # UI ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ player/              # æ’­æ”¾å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ timeline/            # æ—¶é—´è½´æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ effect/              # ç‰¹æ•ˆé¢æ¿
â”‚   â”‚   â””â”€â”€ export/              # å¯¼å‡ºå¯¹è¯æ¡†
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                  # çŠ¶æ€ç®¡ç† (Pinia)
â”‚   â”‚   â”œâ”€â”€ timeline.ts          # æ—¶é—´è½´çŠ¶æ€
â”‚   â”‚   â””â”€â”€ effects.ts           # ç‰¹æ•ˆçŠ¶æ€
â”‚   â”‚
â”‚   â””â”€â”€ types/                   # TypeScript ç±»å‹å®šä¹‰
â”‚       â””â”€â”€ effects.ts           # ç‰¹æ•ˆç±»å‹å®šä¹‰
```

### æ¸²æŸ“æµç¨‹

```mermaid
graph TD
    Clock[PlaybackClock] -->|Tick| MC[MediaController]
    MC -->|Sync| VP[VideoPool]
    MC -->|Frame| Renderer[WebGLRenderer]
    Renderer -->|FBO| EM[EffectManager]
    EM -->|Ping-Pong| Effects[ç‰¹æ•ˆé“¾]
    Effects --> Canvas
    MC -->|Time| Subtitle[SubtitleRenderer]
    Subtitle --> OverlayCanvas
```

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- pnpm 8+

### å®‰è£…ä¸è¿è¡Œ

```bash
# 1. å®‰è£…ä¾èµ–
pnpm install

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build
```

---

## ğŸ¨ æ”¯æŒçš„è§†é¢‘ç‰¹æ•ˆ

| ç‰¹æ•ˆ | æè¿° | ä¸»è¦å‚æ•° |
|------|------|----------|
| Flash | é—ªç™½æ•ˆæœ | é¢œè‰²ã€å¼ºåº¦ |
| Shake | ç”»é¢æŠ–åŠ¨ | é¢‘ç‡ã€æ–¹å‘ |
| Glitch | æ•°å­—æ•…éšœ | RGBåˆ†ç¦»ã€æ‰«æçº¿ã€å—çŠ¶å¹²æ‰° |
| Radial Blur | å¾„å‘æ¨¡ç³Š | ä¸­å¿ƒç‚¹ã€é‡‡æ ·æ•° |
| Chromatic | è‰²å·®æ•ˆæœ | è§’åº¦ |
| Pixelate | åƒç´ åŒ– | åƒç´ å¤§å° |
| Invert | åè‰² | - |
| Film Grain | è€ç”µå½± | é¢—ç²’ã€åˆ’ç—•ã€é—ªçƒã€å¤å¤è‰²è°ƒ |
| Vignette | æš—è§’æ•ˆæœ | åŠå¾„ã€æŸ”å’Œåº¦ |
| Split Screen | åˆ†å± | åˆ†å±æ•°ã€æ–¹å‘ã€é—´éš” |

---

## ğŸ“š æŠ€æœ¯åšå®¢

æ·±å…¥äº†è§£é¡¹ç›®å®ç°ç»†èŠ‚ï¼š

1. [æŠ€æœ¯é€‰å‹ä¸é¡¹ç›®ç»“æ„](./docs/blog/01-architecture.md)
2. [æ—¶é—´è½´æ•°æ®æ¨¡å‹](./docs/blog/02-timeline-state.md)
3. [WebGL æ¸²æŸ“ä¸æ»¤é•œ](./docs/blog/03-webgl-rendering.md)
4. [è½¬åœºåŠ¨ç”»å®ç°](./docs/blog/04-transitions.md)
5. [WebCodecs è§†é¢‘å¯¼å‡º](./docs/blog/05-webcodecs-export.md)
6. [LeaferJS è´´çº¸ç³»ç»Ÿ](./docs/blog/06-leaferjs-sticker.md)
7. [è§†é¢‘ç‰¹æ•ˆç³»ç»Ÿ](./docs/blog/07-effect-system.md)
8. [å…³é”®å¸§åŠ¨ç”»ç³»ç»Ÿ](./docs/blog/08-keyframe-animation.md)

---

## ğŸ“ å¼€å‘è·¯çº¿å›¾

- [x] **v0.1.0**: åŸºç¡€è½¨é“ç¼–è¾‘ï¼ŒWebGL æ¸²æŸ“ï¼ŒHLS æ’­æ”¾
- [x] **v0.2.0**: æ’­æ”¾å¼•æ“é‡æ„ï¼Œå¼•å…¥ VideoPool ä¸ MediaController
- [x] **v0.3.0**: å­—å¹•ç³»ç»Ÿä¸å¤šè½¨é“å±‚çº§åˆæˆ
- [x] **v0.4.0**: è§†é¢‘ç‰¹æ•ˆç³»ç»Ÿï¼ˆ10+ ç‰¹æ•ˆï¼ŒPing-Pong æ¸²æŸ“ï¼‰
- [x] **v0.5.0**: WebCodecs ç¡¬ä»¶åŠ é€Ÿå¯¼å‡º
- [x] **v0.6.0**: å…³é”®å¸§åŠ¨ç”»ç³»ç»Ÿ
- [ ] **v0.7.0**: éŸ³é¢‘ç‰¹æ•ˆä¸å¯è§†åŒ–

---

<p align="center">
  <sub>Designed for Performance, Built for Creators.</sub>
</p>

