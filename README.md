# BaseCut - é«˜æ€§èƒ½ Web è§†é¢‘å‰ªè¾‘å¼•æ“

<p align="center">
  <br>
  <img src="https://img.shields.io/badge/Vue-3.5+-4FC08D?style=flat-square&logo=vue.js" alt="Vue">
  <img src="https://img.shields.io/badge/TypeScript-5.7+-3178C6?style=flat-square&logo=typescript" alt="TypeScript">
  <img src="https://img.shields.io/badge/Vite-6.0+-646CFF?style=flat-square&logo=vite" alt="Vite">
  <img src="https://img.shields.io/badge/WebGL-2.0-990000?style=flat-square&logo=webgl" alt="WebGL">
  <img src="https://img.shields.io/badge/WebCodecs-Enabled-FF6B6B?style=flat-square" alt="WebCodecs">
  <br>
  <sub>åŸºäº WebGL ä¸ WebCodecs çš„ä¸‹ä¸€ä»£äº‘ç«¯è§†é¢‘å‰ªè¾‘è§£å†³æ–¹æ¡ˆï¼ˆå¬å¬å¾—äº†ï¼Œæ‹¿æ¥ç©ç©è¿˜æ˜¯å¯ä»¥çš„ï¼‰</sub>
</p>

---

## âš¡ï¸ æ ¸å¿ƒäº®ç‚¹

### ğŸš€ å·¥ä¸šçº§æ’­æ”¾å¼•æ“
- **MediaController æ¶æ„**ï¼šè‡ªç ”å¤šåª’ä½“æ§åˆ¶å™¨ï¼Œç²¾ç¡®åè°ƒè§†é¢‘ã€éŸ³é¢‘ä¸å­—å¹•åŒæ­¥ã€‚
- **VideoPool é¢„åŠ è½½æŠ€æœ¯**ï¼šåŸºäº LRU (O(1)) ç­–ç•¥çš„è§†é¢‘æ± ï¼Œå®ç°å¤šè½¨é“ç´ æé›¶å»¶è¿Ÿåˆ‡æ¢ä¸æ™ºèƒ½é¢„çƒ­ã€‚
- **PlaybackClock ç²¾ç¡®è®¡æ—¶**ï¼šç‹¬ç«‹äº UI çº¿ç¨‹çš„é«˜ç²¾åº¦æ—¶é’Ÿï¼Œæ¶ˆé™¤ `requestAnimationFrame` å¸¦æ¥çš„ç´¯ç§¯è¯¯å·®ã€‚
- **æ™ºèƒ½æ¸²æŸ“å¾ªç¯**ï¼šåˆ†ç¦»æ¸²æŸ“å¸§ç‡ä¸çŠ¶æ€æ›´æ–°é¢‘ç‡ï¼ˆ20fps UI / 60fps Renderï¼‰ï¼Œå½»åº•è§£å†³ Vue å“åº”å¼å¯¼è‡´çš„æ€§èƒ½ç“¶é¢ˆã€‚

### ğŸ¨ ä¸“ä¸šçº§æ¸²æŸ“èƒ½åŠ›
- **æ¨¡å—åŒ– WebGL æ¸²æŸ“å™¨**ï¼šé‡æ„ä¸ºå¤šæ¨¡å—æ¶æ„ï¼ˆ`WebGLContext`ã€`AnimatedRenderer`ã€`OverlayRenderer`ã€`TransitionRenderer`ï¼‰ï¼Œå…¨æµç¨‹ GPU å›¾åƒå¤„ç†ã€‚
- **10+ è§†é¢‘ç‰¹æ•ˆ**ï¼šé—ªç™½ã€æ•…éšœã€è€ç”µå½±ã€å¾„å‘æ¨¡ç³Šã€è‰²å·®ã€åƒç´ åŒ–ã€æš—è§’ã€åˆ†å±ç­‰ã€‚
- **Ping-Pong æ¸²æŸ“**ï¼šå¤šç‰¹æ•ˆé“¾å¼å åŠ ï¼ŒçŠ¶æ€éš”ç¦»ç¡®ä¿æ¸²æŸ“ä¸€è‡´æ€§ã€‚
- **å¤šå±‚çº§åˆæˆç³»ç»Ÿ**ï¼šæ”¯æŒè§†é¢‘ã€å›¾ç‰‡ã€æ–‡å­—ã€è´´çº¸ç­‰å¤šè½¨é“æ··åˆæ¸²æŸ“ã€‚
- **ç‹¬ç«‹å­—å¹•å±‚**ï¼šåŸºäº Offscreen Canvas çš„é«˜æ€§èƒ½å­—å¹•æ¸²æŸ“ï¼Œæ”¯æŒåŠ¨æ€æ ·å¼ä¸ç²¾ç¡®æ—¶é—´è½´å¯¹é½ã€‚

### ğŸ¬ ä¸“ä¸šå¯¼å‡ºèƒ½åŠ›
- **WebCodecs ç¡¬ä»¶ç¼–ç **ï¼šåˆ©ç”¨ GPU åŠ é€Ÿè§†é¢‘ç¼–ç ï¼Œå¯¼å‡ºé€Ÿåº¦æå‡ 3-5 å€ã€‚
- **é¢„è§ˆå¯¼å‡ºä¸€è‡´**ï¼šç»Ÿä¸€æ¸²æŸ“ç®¡çº¿ï¼Œæ‰€è§å³æ‰€å¾—ã€‚
- **FBO é¢„æ¸²æŸ“**ï¼šç¡®ä¿ç‰¹æ•ˆã€å®½é«˜æ¯”åœ¨å¯¼å‡ºæ—¶ä¸é¢„è§ˆå®Œå…¨ä¸€è‡´ã€‚

### â˜ï¸ äº‘åŸç”Ÿå·¥ä½œæµ
- **HLS æµåª’ä½“æ”¯æŒ**ï¼šåŸç”Ÿæ”¯æŒ m3u8 æµåª’ä½“æ’­æ”¾ï¼Œæ— ç¼å¯¹æ¥äº‘ç«¯è½¬ç èµ„æºã€‚
- **Sprite ç¼©ç•¥å›¾å¼•æ“**ï¼šæ”¯æŒé•¿è§†é¢‘é›ªç¢§å›¾é¢„è§ˆï¼Œæ‹–æ‹½æ—¶é—´è½´å®æ—¶å“åº”ï¼Œé›¶å¡é¡¿ä½“éªŒã€‚
- **æ³¢å½¢å¯è§†åŒ–**ï¼šå¼‚æ­¥åŠ è½½éŸ³é¢‘æ³¢å½¢æ•°æ®ï¼Œåˆ†æ®µå¼ Canvas æ¸²æŸ“ï¼Œæä¾›ç²¾å‡†çš„éŸ³é¢‘ç¼–è¾‘è¾…åŠ©ã€‚

### âª ä¼ä¸šçº§æ’¤é”€/é‡åšç³»ç»Ÿ
- **å‘½ä»¤æ¨¡å¼æ¶æ„**ï¼šæ‰€æœ‰ç¼–è¾‘æ“ä½œå°è£…ä¸ºå¯é€†å‘½ä»¤ï¼Œæ”¯æŒæ— é™æ’¤é”€/é‡åšã€‚
- **æ™ºèƒ½å‘½ä»¤åˆå¹¶**ï¼šè¿ç»­åŒç±»æ“ä½œè‡ªåŠ¨åˆå¹¶ï¼Œå‡å°‘å†å²è®°å½•è†¨èƒ€ã€‚
- **å…¨å±€å¿«æ·é”®**ï¼šåŸç”Ÿ `Ctrl+Z` / `Ctrl+Shift+Z` æ”¯æŒã€‚
- **Store å…¨è¦†ç›–**ï¼šæ—¶é—´è½´ã€ç‰¹æ•ˆã€åŠ¨ç”»ã€é¡¹ç›®è®¾ç½®ç­‰æ‰€æœ‰çŠ¶æ€å‡æ”¯æŒæ’¤é”€ã€‚

---

## ğŸ›  æŠ€æœ¯æ¶æ„

### ç›®å½•ç»“æ„

```
vue-baseCut/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ engine/                    # æ ¸å¿ƒæ’­æ”¾ä¸æ¸²æŸ“å¼•æ“
â”‚   â”‚   â”œâ”€â”€ MediaController.ts     # å¤šåª’ä½“æ€»çº¿æ§åˆ¶ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”‚   â”œâ”€â”€ VideoPool.ts           # è§†é¢‘å…ƒç´ å¤ç”¨æ± ï¼ˆLRU O(1) + æ™ºèƒ½é¢„çƒ­ï¼‰
â”‚   â”‚   â”œâ”€â”€ PlaybackClock.ts       # é«˜ç²¾åº¦æ’­æ”¾æ—¶é’Ÿ
â”‚   â”‚   â”œâ”€â”€ WebGLRenderer.ts       # WebGL ä¸»æ¸²æŸ“å™¨
â”‚   â”‚   â”œâ”€â”€ EffectManager.ts       # ç‰¹æ•ˆç®¡ç†å™¨ï¼ˆPing-Pong æ¸²æŸ“ï¼‰
â”‚   â”‚   â”œâ”€â”€ EffectShaders.ts       # GLSL ç‰¹æ•ˆç€è‰²å™¨é›†åˆ
â”‚   â”‚   â”œâ”€â”€ AnimationEngine.ts     # å…³é”®å¸§åŠ¨ç”»å¼•æ“
â”‚   â”‚   â”œâ”€â”€ HistoryManager.ts      # æ’¤é”€/é‡åšæ ¸å¿ƒå¼•æ“
â”‚   â”‚   â”œâ”€â”€ HistoryTypes.ts        # å†å²è®°å½•ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ WebCodecsExporter.ts   # WebCodecs è§†é¢‘å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ VideoDecoder.ts        # è§†é¢‘è§£ç å™¨
â”‚   â”‚   â”œâ”€â”€ WorkerManager.ts       # Web Worker ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ HLSPlayer.ts           # HLS æµæ’­æ”¾å°è£…
â”‚   â”‚   â”œâ”€â”€ FFmpegCore.ts          # WASM åª’ä½“å¤„ç†æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ renderers/             # æ¨¡å—åŒ–æ¸²æŸ“å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ WebGLContext.ts    # WebGL ä¸Šä¸‹æ–‡ä¸çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ AnimatedRenderer.ts # åŠ¨ç”»æ¸²æŸ“å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ OverlayRenderer.ts  # å åŠ å±‚æ¸²æŸ“å™¨
â”‚   â”‚   â”‚   â””â”€â”€ TransitionRenderer.ts # è½¬åœºæ¸²æŸ“å™¨
â”‚   â”‚   â”œâ”€â”€ shaders/               # GLSL ç€è‰²å™¨
â”‚   â”‚   â””â”€â”€ commands/              # å†å²å‘½ä»¤ç±»
â”‚   â”‚       â”œâ”€â”€ TimelineCommands.ts
â”‚   â”‚       â”œâ”€â”€ EffectCommands.ts
â”‚   â”‚       â”œâ”€â”€ AnimationCommands.ts
â”‚   â”‚       â””â”€â”€ ProjectCommands.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                # UI ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ player/                # æ’­æ”¾å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ timeline/              # æ—¶é—´è½´æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ effect/                # ç‰¹æ•ˆé¢æ¿
â”‚   â”‚   â”œâ”€â”€ animation/             # åŠ¨ç”»é¢æ¿
â”‚   â”‚   â”œâ”€â”€ property/              # å±æ€§é¢æ¿
â”‚   â”‚   â”œâ”€â”€ export/                # å¯¼å‡ºå¯¹è¯æ¡†
â”‚   â”‚   â”œâ”€â”€ upload/                # ä¸Šä¼ ç»„ä»¶
â”‚   â”‚   â””â”€â”€ layout/                # å¸ƒå±€ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                    # çŠ¶æ€ç®¡ç† (Pinia)
â”‚   â”‚   â”œâ”€â”€ timeline/              # æ¨¡å—åŒ–æ—¶é—´è½´çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts           # ä¸»å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ state.ts           # çŠ¶æ€å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ clipOperations.ts  # ç‰‡æ®µæ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ trackOperations.ts # è½¨é“æ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ transitionOperations.ts # è½¬åœºæ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ playbackControl.ts # æ’­æ”¾æ§åˆ¶
â”‚   â”‚   â”‚   â””â”€â”€ utils.ts           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ effects.ts             # ç‰¹æ•ˆçŠ¶æ€ï¼ˆæ”¯æŒæ’¤é”€ï¼‰
â”‚   â”‚   â”œâ”€â”€ animation.ts           # åŠ¨ç”»çŠ¶æ€ï¼ˆæ”¯æŒæ’¤é”€ï¼‰
â”‚   â”‚   â”œâ”€â”€ history.ts             # å†å²è®°å½• Store
â”‚   â”‚   â”œâ”€â”€ project.ts             # é¡¹ç›®è®¾ç½®ï¼ˆæ”¯æŒæ’¤é”€ï¼‰
â”‚   â”‚   â””â”€â”€ resource.ts            # èµ„æºç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ composables/               # Vue ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â””â”€â”€ usePlayerWatchers.ts   # æ’­æ”¾å™¨ç›‘å¬å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ FrameExtractor.ts      # å¸§æå–å™¨
â”‚   â”‚   â”œâ”€â”€ SpriteThumbnailer.ts   # é›ªç¢§å›¾ç¼©ç•¥å›¾
â”‚   â”‚   â”œâ”€â”€ SubtitleRenderer.ts    # å­—å¹•æ¸²æŸ“å™¨
â”‚   â”‚   â”œâ”€â”€ TransitionRenderer.ts  # è½¬åœºæ¸²æŸ“
â”‚   â”‚   â””â”€â”€ WaveformExtractor.ts   # åˆ†æ®µå¼æ³¢å½¢æå–å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                     # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ index.ts               # æ ¸å¿ƒç±»å‹
â”‚   â”‚   â”œâ”€â”€ effects.ts             # ç‰¹æ•ˆç±»å‹
â”‚   â”‚   â””â”€â”€ animation.ts           # åŠ¨ç”»ç±»å‹
â”‚   â”‚
â”‚   â””â”€â”€ db/                        # æœ¬åœ°æ•°æ®åº“ (IndexedDB)
â”‚
â””â”€â”€ docs/
    â””â”€â”€ blog/                      # æŠ€æœ¯åšå®¢æ–‡æ¡£
```

### æ¸²æŸ“æµç¨‹

```mermaid
graph TD
    Clock[PlaybackClock] -->|Tick| MC[MediaController]
    MC -->|Sync| VP[VideoPool<br/>LRU O(1) + æ™ºèƒ½é¢„çƒ­]
    MC -->|Frame| Renderer[WebGLRenderer]
    Renderer -->|FBO| EM[EffectManager]
    EM -->|Ping-Pong| Effects[ç‰¹æ•ˆé“¾]
    Effects --> Canvas
    MC -->|Time| Subtitle[SubtitleRenderer]
    Subtitle --> OverlayCanvas
```

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- pnpm 8+

### å®‰è£…ä¸è¿è¡Œ

```bash
# 1. å®‰è£…ä¾èµ–
pnpm install

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# 4. ç±»å‹æ£€æŸ¥
pnpm type-check
```

---

## ğŸ¨ æ”¯æŒçš„è§†é¢‘ç‰¹æ•ˆ

| ç‰¹æ•ˆ | æè¿° | ä¸»è¦å‚æ•° |
|------|------|----------|
| Flash | é—ªç™½æ•ˆæœ | é¢œè‰²ã€å¼ºåº¦ |
| Shake | ç”»é¢æŠ–åŠ¨ | é¢‘ç‡ã€æ–¹å‘ |
| Glitch | æ•°å­—æ•…éšœ | RGBåˆ†ç¦»ã€æ‰«æçº¿ã€å—çŠ¶å¹²æ‰° |
| Radial Blur | å¾„å‘æ¨¡ç³Š | ä¸­å¿ƒç‚¹ã€é‡‡æ ·æ•° |
| Chromatic | è‰²å·®æ•ˆæœ | è§’åº¦ |
| Pixelate | åƒç´ åŒ– | åƒç´ å¤§å° |
| Invert | åè‰² | - |
| Film Grain | è€ç”µå½± | é¢—ç²’ã€åˆ’ç—•ã€é—ªçƒã€å¤å¤è‰²è°ƒ |
| Vignette | æš—è§’æ•ˆæœ | åŠå¾„ã€æŸ”å’Œåº¦ |
| Split Screen | åˆ†å± | åˆ†å±æ•°ã€æ–¹å‘ã€é—´éš” |

---

## ğŸ”§ ä¸»è¦ä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vue | ^3.5.13 | å‰ç«¯æ¡†æ¶ |
| Pinia | ^2.2.8 | çŠ¶æ€ç®¡ç† |
| Vite | ^6.0.4 | æ„å»ºå·¥å…· |
| TypeScript | ^5.7.2 | ç±»å‹ç³»ç»Ÿ |
| hls.js | ^1.6.15 | HLS æµåª’ä½“æ’­æ”¾ |
| @ffmpeg/ffmpeg | ^0.12.10 | WASM åª’ä½“å¤„ç† |
| leafer-ui | ^1.12.2 | è´´çº¸/ç”»å¸ƒæ¸²æŸ“ |
| idb | ^8.0.1 | IndexedDB å°è£… |

---

## ğŸ“š æŠ€æœ¯åšå®¢

æ·±å…¥äº†è§£é¡¹ç›®å®ç°ç»†èŠ‚ï¼š

1. [æŠ€æœ¯é€‰å‹ä¸é¡¹ç›®ç»“æ„](https://blog.csdn.net/mnhn456/article/details/156680879?spm=1011.2415.3001.5331)
2. [æ—¶é—´è½´æ•°æ®æ¨¡å‹](https://blog.csdn.net/mnhn456/article/details/156686794?spm=1011.2415.3001.5331)
3. [WebGL æ¸²æŸ“ä¸æ»¤é•œ](https://blog.csdn.net/mnhn456/article/details/156686909?spm=1011.2415.3001.5331)
4. [è½¬åœºåŠ¨ç”»å®ç°](https://blog.csdn.net/mnhn456/article/details/156687008?spm=1011.2415.3001.5331)
5. [WebCodecs è§†é¢‘å¯¼å‡º](https://blog.csdn.net/mnhn456/article/details/156687082?spm=1011.2415.3001.5331)
6. [LeaferJS è´´çº¸ç³»ç»Ÿ](https://blog.csdn.net/mnhn456/article/details/156687144?spm=1011.2415.3001.5331)
7. [è§†é¢‘ç‰¹æ•ˆç³»ç»Ÿ](https://blog.csdn.net/mnhn456/article/details/156722034?spm=1011.2415.3001.5331)
8. [å…³é”®å¸§åŠ¨ç”»ç³»ç»Ÿ](https://blog.csdn.net/mnhn456/article/details/156726352?spm=1011.2415.3001.5331)
9. [æ€§èƒ½ä¼˜åŒ–](https://blog.csdn.net/mnhn456/article/details/156730622?spm=1011.2415.3001.5331)
10. [æ’¤é”€/é‡åšç³»ç»Ÿ](https://blog.csdn.net/mnhn456/article/details/156764409?spm=1011.2415.3001.5331)

---

## ğŸ“ å¼€å‘è·¯çº¿å›¾

- [x] **v0.1.0**: åŸºç¡€è½¨é“ç¼–è¾‘ï¼ŒWebGL æ¸²æŸ“ï¼ŒHLS æ’­æ”¾
- [x] **v0.2.0**: æ’­æ”¾å¼•æ“é‡æ„ï¼Œå¼•å…¥ VideoPool ä¸ MediaController
- [x] **v0.3.0**: å­—å¹•ç³»ç»Ÿä¸å¤šè½¨é“å±‚çº§åˆæˆ
- [x] **v0.4.0**: è§†é¢‘ç‰¹æ•ˆç³»ç»Ÿï¼ˆ10+ ç‰¹æ•ˆï¼ŒPing-Pong æ¸²æŸ“ï¼‰
- [x] **v0.5.0**: WebCodecs ç¡¬ä»¶åŠ é€Ÿå¯¼å‡º
- [x] **v0.6.0**: å…³é”®å¸§åŠ¨ç”»ç³»ç»Ÿ
- [x] **v0.7.0**: æ’¤é”€/é‡åšç³»ç»Ÿï¼ˆå‘½ä»¤æ¨¡å¼ï¼Œå…¨ Store è¦†ç›–ï¼‰
- [x] **v0.8.0**: æ¨¡å—åŒ–é‡æ„ï¼ˆWebGLRendererã€Timeline Storeã€VideoPool LRU O(1)ï¼‰
- [ ] **v0.9.0**: éŸ³é¢‘ç‰¹æ•ˆä¸å¯è§†åŒ–å¢å¼º

---

<p align="center">
  <sub>Designed for Performance, Built for Creators.</sub>
</p>
